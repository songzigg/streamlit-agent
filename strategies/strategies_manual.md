# 📘 量化回测策略手册 (Strategy Manual)

本手册详细梳理了目前 "Backtest Lab" 中集成的 8 大核心交易策略。包含每个策略的逻辑原理、适用场景及参数说明。

---

## 1. 均线交叉策略 (Moving Average Crossover)
**类型**: `趋势跟踪 (Trend Following)`
**文件**: `strategies/ma_strategy.py`

### 核心逻辑
- **开仓 (Buy)**:
    1.  **金叉**: 短期均线 (Fast SMA) 上穿 长期均线 (Slow SMA)。
    2.  **量能过滤**: 当日成交量 > 过去 N 天的平均成交量 (确保放量突破)。
    3.  **RSI 辅助 (可选)**: RSI 指标处于多头区间 (> 50)。
- **平仓 (Sell)**:
    1.  **死叉**: 短期均线下穿 长期均线。
    2.  **止盈止损**: 触及固定止盈 (Take Profit) 或 止损 (Stop Loss)比例。

### 核心参数
- `p_fast`: 快线周期 (默认 5)
- `p_slow`: 慢线周期 (默认 20)
- `stop_loss`: 止损比例 (默认 0.05, 即 5%)
- `take_profit`: 止盈比例 (默认 0.15, 即 15%)

### ✅ 适用场景
- **单边趋势市**（牛市主升浪）。
- ❌ **缺点**: 在震荡市中会频繁出现“假突破”，导致左右挨打。

---

## 2. 海龟交易法则 (Turtle Trading)
**类型**: `趋势突破 (Breakout)`
**文件**: `strategies/turtle_strategy.py`

### 核心逻辑
- **开仓 (Buy)**: 价格突破过去 `N1` 天的**最高价** (Donchian Channel High)。
- **平仓 (Sell)**:
    1.  价格跌破过去 `N2` 天的**最低价** (Donchian Channel Low)。
    2.  **移动止损 (Trailing Stop)**: 价格从持仓后的最高点回撤超过 N%。

### 核心参数
- `entry_period`: 入场突破周期 (默认 20 天)
- `exit_period`: 离场跌破周期 (默认 10 天)
- `trailing_stop_pct`: 移动止损比例 (本案例设为 0.05 即 5%)

### ✅ 适用场景
- **大波动趋势市**。能抓住翻倍大牛股。
- ❌ **缺点**: 胜率通常较低 (40%左右)，依靠少量的暴利交易覆盖频繁的小亏损。

---

## 3. MACD 趋势策略 (MACD Trend)
**类型**: `趋势动量 (Momentum)`
**文件**: `strategies/macd_strategy.py`

### 核心逻辑
- **开仓 (Buy)**:
    1.  **MACD 金叉**: DIF 线(快) 上穿 DEA 线(慢)。
    2.  **多头确认**: MACD 柱状图 > 0 (可选增强条件)。
- **平仓 (Sell)**: **MACD 死叉**: DIF 线下穿 DEA 线。

### 核心参数
- `p_fast`: 快线 EMA (默认 12)
- `p_slow`: 慢线 EMA (默认 26)
- `p_signal`: 信号线 DEA (默认 9)

### ✅ 适用场景
- **中长线趋势**。相比纯均线，MACD 对价格变化的反应更平滑，杂波略少。

---

## 4. 布林带策略 (Bollinger Bands)
**类型**: `均值回归 (Mean Reversion)`
**文件**: `strategies/bollinger_strategy.py`

### 核心逻辑
- **开仓 (Buy)**: 价格跌破 **布林带下轨** (视为超卖/被低估，赌价格回归中枢)。
- **平仓 (Sell)**: 价格突破 **布林带上轨** (视为超买/高估)。

### 核心参数
- `period`: 中轨均线周期 (默认 20)
- `devfactor`: 标准差倍数 (默认 2.0，倍数越大，触发机会越少但信号越强)

### ✅ 适用场景
- **震荡市 (Range Bound)**。在箱体震荡中高抛低吸效果极佳。
- ❌ **缺点**: 在强烈单边下跌趋势中，会因为“跌破下轨”而过早抄底接飞刀。

---

## 5. RSI 反转策略 (RSI Reversion)
**类型**: `摆动反转 (Oscillator)`
**文件**: `strategies/rsi_strategy.py`

### 核心逻辑
- **开仓 (Buy)**: RSI 数值 < `Low` (如 30)，进入超卖区，预期反弹。
- **平仓 (Sell)**: RSI 数值 > `High` (如 70)，进入超买区，预期回调。

### 核心参数
- `period`: RSI 计算周期 (默认 14)
- `low`: 超卖阈值 (默认 30, 低于此值买入)
- `high`: 超买阈值 (默认 70, 高于此值卖出)

### ✅ 适用场景
- **震荡市** 或 **短线反弹**。
- ❌ **缺点**: 同样害怕单边大熊市，容易指标钝化（长期处于超卖区但价格一直跌）。

---

## 6. KDJ 随机指标 (KDJ Strategy)
**类型**: `短线摆动 (Swing)`
**文件**: `strategies/kdj_strategy.py`

### 核心逻辑
- **开仓 (Buy)**:
    1.  **超卖**: J 值 < 0。
    2.  **金叉**: K 线在低位 (K<20) 上穿 D 线。
- **平仓 (Sell)**:
    1.  **超买**: J 值 > 100。
    2.  **死叉**: K 线在高位 (K>80) 下穿 D 线。

### 核心参数
- `period`: 9 (计算周期)
- `dfast`: 3
- `dslow`: 3

### ✅ 适用场景
- **A股短线**。对价格敏感度极高，适合抓取几天的反弹行情。

---

## 7. Dual Thrust (双重推进)
**类型**: `日内/波段突破 (Breakout)`
**文件**: `strategies/dual_thrust_strategy.py`

### 核心逻辑
- 计算前 N 天的**震幅 (Range)** = Max(HH-LC, HC-LL)。
- **开仓**: 今日开盘价 + K1 * Range。
- **平仓**: 跌破止损线 (本系统简化为反向信号或固定止损)。

### 核心参数
- `period`: 计算震幅的天数 (默认 5)
- `k1`: 上轨系数 (默认 0.5)

### ✅ 适用场景
- **日内波动大** 或 **走出盘整** 的股票。

---

## 8. DIY 组合策略 (Composite Strategy)
**类型**: `自定义 (Custom)`
**文件**: `strategies/composite_strategy.py`

### 核心逻辑
这是一个策略容器，允许用户像拼积木一样组合信号。
1.  **主信号**: 选择 MACD / KDJ / RSI / Turtle 之一。
2.  **趋势过滤**: 只有股价 > 60 日均线 (牛市) 才允许开仓。
3.  **成交量确认**: 只有当日成交量 > 20 日平均成交量 (放量) 才允许开仓。

### ✅ 适用场景
- 试图过滤掉“假信号”的进阶交易者。比如在 KDJ 基础上增加趋势过滤，能显著提高胜率。

---

## 📊 策略特性对比表

| 策略名称 | 核心类型 | 胜率特征 | 盈亏比特征 | 适合行情 | 风险管理特性 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **Moving Average** | 趋势 | 中 | 中 | 单边上涨 | ✅ 固定 SL/TP |
| **Turtle Trading** | 趋势 | 低 | 高 (三年不开张，开张吃三年) | 大趋势/波动大 | ✅ 移动止损 |
| **MACD Trend** | 趋势 | 中 | 中 | 中长线趋势 | ❌ 仅依赖死叉 |
| **Bollinger** | 回归 | 高 | 低 (吃小波段) | 震荡盘整 | ❌ 仅依赖上轨 |
| **RSI Reversion** | 反转 | 高 | 低 | 震荡/超跌反弹 | ❌ 仅依赖超买 |
| **KDJ** | 短线 | 极高 | 低 | 短线波动 | ❌ 仅依赖超买 |
| **Dual Thrust** | 突破 | 中 | 高 | 突破盘整 | ❌ 仅依赖反转 |
